<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CSV Revenue & Quantity Reports</title>
    <meta name="description" content="Upload CSVs and generate revenue/quantity reports.">
    <meta property="og:title" content="CSV Revenue & Quantity Reports">
    <meta property="og:description" content="Upload CSVs and generate revenue/quantity reports.">
    <meta property="og:type" content="website">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
      .container { max-width: 1100px; }
      .hidden { display: none; }
      .monospace { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
    <link rel="icon" href="data:,">
  </head>
  <body class="bg-gray-50 text-gray-900">
    <header class="bg-white border-b border-gray-200 sticky top-0 z-10">
      <div class="container mx-auto px-4 py-3 flex items-center justify-between">
        <h1 class="text-lg font-semibold">Reports Dashboard</h1>
        <nav class="flex gap-4 text-sm">
          <a href="#/upload" class="nav-link text-gray-600 hover:text-gray-900">Upload</a>
          <a href="#/report" class="nav-link text-gray-600 hover:text-gray-900">Report</a>
          <a href="#/history" class="nav-link text-gray-600 hover:text-gray-900">History</a>
          <a href="#/settings" class="nav-link text-gray-600 hover:text-gray-900">Settings</a>
        </nav>
      </div>
    </header>

    <main class="container mx-auto px-4 py-6">
      <!-- Upload View -->
      <section id="view-upload" class="view">
        <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-5">
          <h2 class="text-base font-medium mb-4">Upload CSV</h2>
          <input id="fileInput" type="file" accept=".csv,text/csv" class="block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200">
          <div id="parseOptions" class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm text-gray-600 mb-1">Date column</label>
              <select id="col-date" class="w-full border rounded-md px-3 py-2 text-sm"></select>
            </div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Item/SKU column</label>
              <select id="col-item" class="w-full border rounded-md px-3 py-2 text-sm"></select>
            </div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Quantity column</label>
              <select id="col-qty" class="w-full border rounded-md px-3 py-2 text-sm"></select>
            </div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Price column (optional)</label>
              <select id="col-price" class="w-full border rounded-md px-3 py-2 text-sm"></select>
            </div>
            <div>
              <label class="block text-sm text-gray-600 mb-1">Revenue column (optional)</label>
              <select id="col-revenue" class="w-full border rounded-md px-3 py-2 text-sm"></select>
            </div>
          </div>
          <div class="mt-4 flex items-center gap-3">
            <button id="btnParse" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 disabled:opacity-50">Parse & Generate</button>
            <span id="uploadStatus" class="text-sm text-gray-600"></span>
          </div>
        </div>
      </section>

      <!-- Report View -->
      <section id="view-report" class="view hidden">
        <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-5">
          <div class="flex items-center justify-between">
            <h2 class="text-base font-medium">Report</h2>
            <div class="flex gap-2">
              <button id="btnExportItem" class="px-3 py-1.5 border rounded-md text-sm">Export Items CSV</button>
              <button id="btnExportDate" class="px-3 py-1.5 border rounded-md text-sm">Export Dates CSV</button>
              <button id="btnSaveReport" class="px-3 py-1.5 bg-blue-600 text-white rounded-md text-sm">Save Report</button>
            </div>
          </div>
          <div id="totals" class="mt-4 grid grid-cols-1 sm:grid-cols-3 gap-3"></div>
          <div class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <h3 class="text-sm font-semibold mb-2">By Item</h3>
              <div id="table-item" class="overflow-auto border rounded-md"></div>
            </div>
            <div>
              <h3 class="text-sm font-semibold mb-2">By Date</h3>
              <div id="table-date" class="overflow-auto border rounded-md"></div>
            </div>
          </div>
          <div class="mt-6">
            <h3 class="text-sm font-semibold mb-2">Revenue by Date</h3>
            <canvas id="chart-revenue" height="120"></canvas>
          </div>
        </div>
      </section>

      <!-- History View -->
      <section id="view-history" class="view hidden">
        <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-5">
          <div class="flex items-center justify-between">
            <h2 class="text-base font-medium">History</h2>
            <button id="btnRefreshHistory" class="px-3 py-1.5 border rounded-md text-sm">Refresh</button>
          </div>
          <div id="historyList" class="mt-4 divide-y"></div>
        </div>
      </section>

      <!-- Settings View -->
      <section id="view-settings" class="view hidden">
        <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-5">
          <h2 class="text-base font-medium">Settings</h2>
          <div class="mt-4 text-sm">
            <p id="authStatus">Not signed in.</p>
            <div class="mt-3 flex gap-2">
              <button id="btnSignIn" class="px-3 py-1.5 border rounded-md">Sign in with Google</button>
              <button id="btnSignOut" class="px-3 py-1.5 border rounded-md hidden">Sign out</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Vendor libs -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

    <!-- Firebase init (loads config from assets/js/firebase.js) -->
    <script type="module" src="./assets/js/firebase-init.js"></script>

    <!-- App scripts -->
    <script type="module" src="./assets/js/app.js"></script>
  </body>
  </html>

